<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-architecture" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">System architecture | MPFS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cardano-foundation.github.io/mpfs/img/anti-cli-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://cardano-foundation.github.io/mpfs/img/anti-cli-social-card.jpg"><meta data-rh="true" property="og:url" content="https://cardano-foundation.github.io/mpfs/docs/architecture"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="System architecture | MPFS"><meta data-rh="true" name="description" content="Components"><meta data-rh="true" property="og:description" content="Components"><link data-rh="true" rel="icon" href="/mpfs/img/cardano-ada-logo.svg"><link data-rh="true" rel="canonical" href="https://cardano-foundation.github.io/mpfs/docs/architecture"><link data-rh="true" rel="alternate" href="https://cardano-foundation.github.io/mpfs/docs/architecture" hreflang="en"><link data-rh="true" rel="alternate" href="https://cardano-foundation.github.io/mpfs/docs/architecture" hreflang="x-default"><link rel="stylesheet" href="/mpfs/assets/css/styles.8806e0c1.css">
<script src="/mpfs/assets/js/runtime~main.85c3884e.js" defer="defer"></script>
<script src="/mpfs/assets/js/main.a144596b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/mpfs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mpfs/"><div class="navbar__logo"><img src="/mpfs/img/logo.svg" alt="Cardano Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/mpfs/img/logo.svg" alt="Cardano Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MPFS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mpfs/docs/intro">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cardano-foundation/mpfs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mpfs/docs/intro">Introduction to MPFS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/mpfs/docs/architecture">System architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/mpfs/docs/manual/signingless">User Manual</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mpfs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">System architecture</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>System architecture</h1></header>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a href="#components" class="hash-link" aria-label="Direct link to Components" title="Direct link to Components">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mpf-token">MPF Token<a href="#mpf-token" class="hash-link" aria-label="Direct link to MPF Token" title="Direct link to MPF Token">​</a></h3>
<p>The MPF token is a native token living on the Cardano blockchain. It is associated with a merkle trie root and the public key hash of the oracle controlling it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mpf-token-facts">MPF Token facts<a href="#mpf-token-facts" class="hash-link" aria-label="Direct link to MPF Token facts" title="Direct link to MPF Token facts">​</a></h3>
<p>Facts are key-value pairs stored in the merkle trie associated with an MPF token. They represent the knowledge stored in the database.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parties">Parties<a href="#parties" class="hash-link" aria-label="Direct link to Parties" title="Direct link to Parties">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="blockchain">Blockchain<a href="#blockchain" class="hash-link" aria-label="Direct link to Blockchain" title="Direct link to Blockchain">​</a></h3>
<p>The blockchain is used to store the state of the knowledge database and to validate operations on it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oracle">Oracle<a href="#oracle" class="hash-link" aria-label="Direct link to Oracle" title="Direct link to Oracle">​</a></h3>
<p>Someone who controls which facts are part of an MPF token.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="requester">Requester<a href="#requester" class="hash-link" aria-label="Direct link to Requester" title="Direct link to Requester">​</a></h3>
<p>Anyone who wants to change the facts in an MPF token.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="observer">Observer<a href="#observer" class="hash-link" aria-label="Direct link to Observer" title="Direct link to Observer">​</a></h3>
<p>Anyone who needs to queries the knowledge database and/or use any fact as input to a smart contract.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="facts-storage">Facts Storage<a href="#facts-storage" class="hash-link" aria-label="Direct link to Facts Storage" title="Direct link to Facts Storage">​</a></h3>
<p>All knowledge is stored on the blockchain history, so it&#x27;s reconstructable by anyone with access to it.
Moreover each of its facts are referrable as transaction inputs to be consumed in smart contracts as if they were stored in the current state of the blockchain.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="token-ownership">Token Ownership<a href="#token-ownership" class="hash-link" aria-label="Direct link to Token Ownership" title="Direct link to Token Ownership">​</a></h3>
<p>The token owner (a.k.a. oracle) is the only one who can add or remove facts from the database. To do so he has to consume requests from requesters. In the current shape of the system, the oracle has full control over the facts, but in the future it could be possible to implement a more decentralized model where this power is distributed among multiple parties.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="interaction">Interaction<a href="#interaction" class="hash-link" aria-label="Direct link to Interaction" title="Direct link to Interaction">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mpf-token-1">MPF Token<a href="#mpf-token-1" class="hash-link" aria-label="Direct link to MPF Token" title="Direct link to MPF Token">​</a></h3>
<p>We refer to the current state of the knowledge as the &quot;MPF token&quot;. The token is the only value that is part of the blockchain state and it contains the hash of the current facts and the public key of the oracle controlling it.
All tokens are sitting at the system address which is determined by the smart contract controlling its identifier and its updating.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="token-transactions">Token Transactions<a href="#token-transactions" class="hash-link" aria-label="Direct link to Token Transactions" title="Direct link to Token Transactions">​</a></h3>
<p>3 transactions are possible involving tokens</p>
<ol>
<li><strong>Boot</strong>: Anyone can become an oracle by creating a new MPF token. This token will be started with the null hash and be uniquely identified by an id, the token-id. The oracle will also set the public key of the oracle in the token.</li>
<li><strong>Update</strong>: The oracle can update the MPF token by adding or removing facts from the database. This transaction will consume requests from contributorts and will update the knowledge hash in the token and potentially change the ownership of the token.</li>
<li><strong>End</strong>: The oracle can delete the MPF token, which will remove the token-id, so no other updates can be applied on it. Future versions of this sytem will allow to use a deleted token knowledge hash as a starting point for a new MPF token, so the knowledge can be transferred in a new token without losing the history of the previous one.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="change-requests">Change Requests<a href="#change-requests" class="hash-link" aria-label="Direct link to Change Requests" title="Direct link to Change Requests">​</a></h3>
<p>Facts contributors can send requests to the system address. They will be spent in one update token transaction of the token they are referring to. The request will contain the key and the value to be added or removed from the knowledge database as well as the token-id of the MPF token they wantt to be applied to.
The request will also contain the public key of the requester, so</p>
<ul>
<li>The request publisher can retract the request if needed.</li>
<li>The oracle knows how to restitute part of the value that is locked in the request to the contributor.</li>
</ul>
<p>3 Transactions are possible involving requests</p>
<ol>
<li><strong>Request</strong>: Anyone can create a request to add or remove knowledge from the database. The request will be stored in the blockchain state and can be consumed by the oracle in the update transaction.</li>
<li><strong>Retract</strong>: The requester can retract the request in case the oracle does not accept it.</li>
<li><strong>Update</strong>: This is the same transaction as the update of the MPF token, which consumes both a token and the requests that were targeting it.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="smart-contracts">Smart contracts<a href="#smart-contracts" class="hash-link" aria-label="Direct link to Smart contracts" title="Direct link to Smart contracts">​</a></h3>
<p>A smart contrat is involved in <code>boot</code>, <code>update</code>, <code>end</code>, and <code>retract</code> transactions.
For each of these transactions, the smart contract will enforce rules to ensure the integrity of the knowledge database and the validity of the transactions.</p>
<ul>
<li><code>boot</code>:<!-- -->
<ul>
<li>The new token-id is unique</li>
<li>The hash in the token is null (this is the hash of the knowledge database, implying an empty database)</li>
</ul>
</li>
<li><code>update</code>:<!-- -->
<ul>
<li>All consumed change-requests have their referred token consumed as well</li>
<li>All requests are coupled with a proof that the update is actually performed to the knowledge database</li>
<li>The token remains at the system address</li>
<li>The token owner is the one who is performing the update</li>
</ul>
</li>
<li><code>end</code>:<!-- -->
<ul>
<li>The token owner is the one who is performing the end</li>
</ul>
</li>
<li><code>retract</code>:<!-- -->
<ul>
<li>The request publisher is the one who is performing the retract</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-example">Protocol example<a href="#protocol-example" class="hash-link" aria-label="Direct link to Protocol example" title="Direct link to Protocol example">​</a></h2>
</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/cardano-foundation/mpfs/tree/main/docs/docs/architecture.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mpfs/docs/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction to MPFS</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mpfs/docs/manual/signingless"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Signingless MPFS Manual</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#components" class="table-of-contents__link toc-highlight">Components</a><ul><li><a href="#mpf-token" class="table-of-contents__link toc-highlight">MPF Token</a></li><li><a href="#mpf-token-facts" class="table-of-contents__link toc-highlight">MPF Token facts</a></li></ul></li><li><a href="#parties" class="table-of-contents__link toc-highlight">Parties</a><ul><li><a href="#blockchain" class="table-of-contents__link toc-highlight">Blockchain</a></li><li><a href="#oracle" class="table-of-contents__link toc-highlight">Oracle</a></li><li><a href="#requester" class="table-of-contents__link toc-highlight">Requester</a></li><li><a href="#observer" class="table-of-contents__link toc-highlight">Observer</a></li></ul></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#facts-storage" class="table-of-contents__link toc-highlight">Facts Storage</a></li><li><a href="#token-ownership" class="table-of-contents__link toc-highlight">Token Ownership</a></li></ul></li><li><a href="#interaction" class="table-of-contents__link toc-highlight">Interaction</a><ul><li><a href="#mpf-token-1" class="table-of-contents__link toc-highlight">MPF Token</a></li><li><a href="#token-transactions" class="table-of-contents__link toc-highlight">Token Transactions</a></li><li><a href="#change-requests" class="table-of-contents__link toc-highlight">Change Requests</a></li><li><a href="#smart-contracts" class="table-of-contents__link toc-highlight">Smart contracts</a></li></ul></li><li><a href="#protocol-example" class="table-of-contents__link toc-highlight">Protocol example</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mpfs/docs/intro">Getting Started</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Cardano Foundation, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>