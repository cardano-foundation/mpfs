"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[3976],{7879:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"intro","title":"Introduction to MPFS","description":"Merkle Patricia Forestry","source":"@site/docs/intro.md","sourceDirName":".","slug":"/intro","permalink":"/mpfs/docs/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/cardano-foundation/mpfs/tree/main/docs/docs/intro.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","next":{"title":"System architecture","permalink":"/mpfs/docs/architecture"}}');var s=n(4848),o=n(8453);const r={},a="Introduction to MPFS",c={},l=[{value:"Merkle Patricia Forestry",id:"merkle-patricia-forestry",level:2},{value:"Design choices to run MPF on Cardano",id:"design-choices-to-run-mpf-on-cardano",level:3},{value:"MPFS: the service",id:"mpfs-the-service",level:2},{value:"Pre-requisites",id:"pre-requisites",level:2},{value:"Getting started",id:"getting-started",level:2},{value:"Docker",id:"docker",level:3},{value:"Source",id:"source",level:3},{value:"Usage",id:"usage",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"introduction-to-mpfs",children:"Introduction to MPFS"})}),"\n",(0,s.jsx)(t.h2,{id:"merkle-patricia-forestry",children:"Merkle Patricia Forestry"}),"\n",(0,s.jsxs)(t.p,{children:["A Merkle Patricia Forestry (MPF) is a data structure that allows storing key-value pairs (facts) in a verifiable and immutable way on the a blockchain.\nFor a primer on MPF, see ",(0,s.jsx)(t.a,{href:"https://cardanofoundation.org/blog/merkle-patricia-tries-deep-dive",children:"CF Presentation"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"Storing facts inside an MPF provides cryptographic proofs of inclusion and exclusion for each fact, allowing anyone to verify the integrity of the data. When an MPF is available inside a UTxO on the Cardano blockchain i.e., transactions can refer to it as input to pass smart contract validation."}),"\n",(0,s.jsx)(t.p,{children:"How to provide and access MPF's facts and how to publish the MPF root is left to be decided.\nMPFS takes some decisions to provide a complete solution to manage MPF tokens on Cardano."}),"\n",(0,s.jsx)(t.h3,{id:"design-choices-to-run-mpf-on-cardano",children:"Design choices to run MPF on Cardano"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"All modifications to an MPF root have to appear on-chain. This gives anyone with access to the blockchain history the ability to reconstruct the full history of changes and so the current facts."}),"\n",(0,s.jsx)(t.li,{children:"All modifications must be consumed under a smart contract validation. This eliminates the burden to prove that an MPF contains only facts that are the result of modifications that have been on chain."}),"\n",(0,s.jsx)(t.li,{children:"MPF are owned. This gives the smart contract the ability to operate on multiple MPF tokens, each controlled by a different user. Products of MPF roots and owners are referred to as MPF tokens from now on."}),"\n",(0,s.jsxs)(t.li,{children:["MPF token can be modified only by their owner. This gives full control to the owner on which facts are part of the MPF token. The owner of an MPF token is referred to as ",(0,s.jsx)(t.code,{children:"oracle"})," from now on."]}),"\n",(0,s.jsx)(t.li,{children:"MPF tokens have a unique identifier. This gives the ability to address a specific MPF token inside a modification."}),"\n",(0,s.jsxs)(t.li,{children:["Specific MPF modifications are owned. This gives the modification requester the ability to retract modifications if they are not accepted by the owner. The owner of a modification request is referred to as ",(0,s.jsx)(t.code,{children:"requester"})," from now on."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"mpfs-the-service",children:"MPFS: the service"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.em,{children:"MPFS"})," is an http service wrapping"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["MPF operations from the ",(0,s.jsx)(t.a,{href:"https://github.com/aiken-lang/merkle-patricia-forestry",children:"Merkle Patricia Forestry library"})," in one smart contract to track and validate each MPF history of changes"]}),"\n",(0,s.jsx)(t.li,{children:"an off-chain transaction builder that helps building transactions to interact with the smart contract"}),"\n",(0,s.jsx)(t.li,{children:"an indexer over the smart contract events to reconstruct and serve the MPF state"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"It is designed to be used by anyone who wants to store and manage knowledge in a decentralized manner, allowing contributors to add or remove facts while ensuring the integrity and history of the knowledge database."}),"\n",(0,s.jsx)(t.p,{children:"It is particularly useful for applications that require a verifiable and immutable record of knowledge, such as decentralized applications (dApps), knowledge management systems, and collaborative platforms."}),"\n",(0,s.jsx)(t.p,{children:"The service comes in 2 flavors signingful and signingless. The signingful version is suitable for local installations where it controls a private key for the user, while the signingless version is suitable for remote installations where the user has to provide a signature for each transaction. This introduction focuses on the signingless version, which is the one used in production in some projects."}),"\n",(0,s.jsx)(t.h2,{id:"pre-requisites",children:"Pre-requisites"}),"\n",(0,s.jsx)(t.p,{children:"Being an HTTP service no particular skill is required to use it, but some knowledge of Cardano transactions and smart contracts is useful to understand how to interact with it."}),"\n",(0,s.jsx)(t.p,{children:"Deployment has some external requirements:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"https://github.com/bloxbean/yaci-store",children:"Yaci store"}),". This is required to provide address to utxo mapping. When building transactions the user will provide an address that he controls and wants to spend from. The service will use the Yaci store to find the UTxOs that are associated with that address and build the transaction accordingly."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"https://github.com/cardanoSolutions/ogmios",children:"Ogmios"}),". This is required to track the events involving the system address."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"https://github.com/intersectMBO/cardano-node",children:"Cardano node"}),". This is indirectly required by both Yaci store and Ogmios."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The mpfs service in itself is a typescript application so any nodejs supported platform should be able to run it. It is tested on Linux and MacOS, but it should work on Windows as well."}),"\n",(0,s.jsx)(t.h2,{id:"getting-started",children:"Getting started"}),"\n",(0,s.jsx)(t.h3,{id:"docker",children:"Docker"}),"\n",(0,s.jsx)(t.p,{children:"The image is available on ghcr.io and can be pulled with the command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker pull ghcr.io/cardano-foundation/mpfs/mpfs:v1.1.0\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This is an expample of a working deployment: ",(0,s.jsx)(t.a,{href:"https://github.com/cardano-foundation/hal/blob/main/docs/deployment/mpfs/docker-compose.yml",children:"mpfs in CF"}),"\nConsider sourcing ",(0,s.jsx)(t.a,{href:"https://github.com/cardano-foundation/hal/blob/main/docs/deployment/mpfs/bootstrap.sh",children:"bootstrap.sh"})," as mentioned in ",(0,s.jsx)(t.a,{href:"https://github.com/cardano-foundation/hal/blob/main/docs/deployment/mpfs/README.md",children:"setup instructions"})," to speedup the node syncing."]}),"\n",(0,s.jsx)(t.h3,{id:"source",children:"Source"}),"\n",(0,s.jsx)(t.p,{children:"Altenatively, you can run the service from source. To do so, you need to have nodejs and npm and installed on your system. Then you can clone the repository and run the following commands:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"git clone https://github.com/cardano-foundation/mpfs\ncd off_chain\nnpx tsx src/service/signingless/main.ts --port 3000 \\\n    --provider yaci --yaci-store-host http://localhost:8080 \\\n    --ogmios-host http://localhost:1337 \\\n    --database-path ./mpfs.db \\\n    --since-slot 94898393 \\\n    --since-block-id ef94934f8eb129ebf07eeaab007b81ecb1bc58b121d19ac0ffe81f928bf56cc\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This will start the service on port 3000, using the Yaci store running on ",(0,s.jsx)(t.a,{href:"http://localhost:8080",children:"http://localhost:8080"})," and the Ogmios server running on ",(0,s.jsx)(t.a,{href:"http://localhost:1337",children:"http://localhost:1337"}),". The database will be stored in the file ",(0,s.jsx)(t.code,{children:"mpfs.db"})," in the current directory. The ",(0,s.jsx)(t.code,{children:"since-slot"})," and ",(0,s.jsx)(t.code,{children:"since-block-id"})," parameters are used to specify the starting point for the service to track events."]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"Be careful to start indexing before the token you are going to use was created. If you are creating a new token, just start from nowish."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://mpfs.plutimus.com/api-docs",children:"Signingless API Reference"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);